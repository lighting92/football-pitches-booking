@model FootballPitchesBooking.Models.StadiumModels.JoinRivalModel
@{
    ViewBag.RIVAL = "active";
    ViewBag.Title = "Thông tin chi tiết của kèo";
}

<script type="text/ecmascript">
    function check() {
        var flag = 0;
        var rivalName = $("input[name=RivalName]").val();
        var rivalemail = $("input[name=RivalEmail]").val();
        var rivalphone = $("input[name=RivalPhone]").val();
        var reg = /^(\w+[\.])*\w+@@(\w+\.)+[a-zA-Z]+$/;
        var aln = /^[a-z|A-Z|0-9]*$/;

        if (hasRival == 'True') {
            if (rivalName.length < 1 || rivalName.length > 30) {
                $("#RivalName_Error").text("Yêu cầu phải từ 1 đến 30 kí tự");
                $("#RivalName_Error").css("display", "block");
                flag++;

            }
            else {
                $("#RivalName_Error").text(" ");
                $("#RivalName_Error").css("display", "none");
            }

            if (!reg.test(rivalemail)) {
                $("#RivalEmail_Error").text("Email không đúng");
                $("#RivalEmail_Error").css("display", "block");
                flag++;
            }
            else {
                $("#RivalEmail_Error").text(" ");
                $("#RivalEmail_Error").css("display", "none");
            }

            if (rivalphone.length > 0 && (rivalphone.length < 10 || rivalphone.length > 11)) {
                $("#RivalPhone_Error").text("Yêu cầu phải nhập đúng số điện thoại");
                $("#RivalPhone_Error").css("display", "block");
                flag++;

            }
            else {
                $("#RivalPhone_Error").text(" ");
                $("#RivalPhone_Error").css("display", "none");
            }
        }

        if (flag > 0) {
            return false;
        } else return true;
    }
</script>

<div class="row join-rival">
    <div class="span12">
        <div class="row">
            <div class="span9">
                <form action="JoinRival?Id=@Request.QueryString["id"]" method="post">
                    <fieldset>
                        <h2>THÔNG TIN CHI TIẾT
                            <br />
                            KÈO ĐÁ BÓNG</h2>
                        @if (Model.ErrorMessages != null && Model.ErrorMessages.Count() > 0)
                        {
                            <div class="alert alert-danger">
                                @foreach (var error in Model.ErrorMessages)
                                {
                                    <p>- @error</p>
                                }
                            </div>
                        }
                        <div class="row">
                            <div class="span9">
                                <h4>THÔNG TIN ĐẶT SÂN:</h4>
                            </div>
                            <div class="span3">
                                <label>
                                    Số sân
                                    <input name="Field" id="Field" type="text" value="@Model.Resv.Field.Number" disabled="disabled">
                                </label>
                            </div>
                            <div class="span6">
                                <label>
                                    Hệ thống sân <b>@Model.Resv.Field.Stadium.Name</b>
                                    <input style="width: 450px;" name="Stadium" id="Stadium" type="text" value="@string.Concat(Model.Resv.Field.Stadium.Street, ", ", Model.Resv.Field.Stadium.Ward, ", ", Model.Resv.Field.Stadium.District)" disabled="disabled">
                                </label>
                            </div>
                            <div class="span3">
                                <label>
                                    Ngày đặt
                                    <input name="Date" id="Date" type="text" placeholder="Ngày đặt sân" required="required" value="@Model.Resv.Date.ToString("dd/MM/yyyy")" disabled="disabled">
                                </label>
                            </div>
                            <div class="span3">
                                <label>
                                    Giờ đặt
                                    <div class="input-append bootstrap-timepicker">
                                        <input name="StartTime" id="startTime" type="text" class="span2 input-time-collapse" value="@((int)Model.Resv.StartTime):@(((int)(Model.Resv.StartTime - (int)Model.Resv.StartTime) * 60).ToString("00"))" disabled="disabled"/>
                                    </div>
                                </label>
                            </div>
                            <div class="span3">
                                <label>
                                    Thời lượng
                                    <input name="Duration" id="Duration" type="text" value="@(Model.Resv.Duration * 60) phút" disabled="disabled">
                                </label>
                            </div>
                        </div>
                        <hr />
                        <div class="row">
                            <div class="span9">
                                <h4>THÔNG TIN chủ kèo:</h4>
                            </div>
                            @if (Model.Resv.User != null)
                            {
                                <div class="span3">
                                    <label>
                                        Tên chủ kèo
                                    <input name="Customer" type="text" placeholder="Tên khách hàng" required="required" value="@Model.Resv.User.UserName" disabled="disabled">
                                    </label>
                                </div>
                                <div class="span3" style="visibility: hidden;">
                                    <label>&nbsp</label>
                                    <input type="text">
                                    <div class="alert alert-danger" style="display: none"></div>
                                </div>
                                <div class="span3" style="visibility: hidden;">
                                    <label>&nbsp</label>
                                    <input type="text">
                                    <div class="alert alert-danger" style="display: none"></div>
                                </div>
                            }
                            <div class="span3">
                                <label>
                                    Tên đầy đủ
                                    <input name="FullName" type="text" placeholder="Tên đầy đủ" required="required" value="@Model.Resv.FullName" disabled="disabled">
                                </label>
                            </div>
                            <div class="span3">
                                <label>
                                    Số điện thoại
                                    <input name="PhoneNumber" id="phoneNumber" type="text" placeholder="Số điện thoại" required="required" value="@Model.Resv.PhoneNumber" disabled="disabled">
                                </label>
                            </div>
                            <div class="span3">
                                <label>
                                    Email
                                    <input name="Email" type="text" placeholder="Email" required="required" value="@Model.Resv.Email" disabled="disabled">
                                </label>
                            </div>
                        </div>
                        @if (!(Model.Resv.User != null && Model.Resv.User.UserName.Equals(User.Identity.Name)))
                        {
                                        
                            <div class="row">
                                <div class="span3">
                                    <label>
                                        Bạn muốn cáp kèo này?
                                    <select id="AcceptRival" name="AcceptRival">
                                        <option value="False">Không</option>
                                        <option value="True">Có</option>
                                    </select>

                                    </label>
                                    <script type="text/javascript">
                                        $(document).ready(function () {
                                            if ($('#AcceptRival').val() == 'True') {
                                                $('#RivalInfo,#joinRival').show();
                                            }
                                            else {
                                                $('#RivalInfo,#joinRival').hide();
                                            }
                                            $('#AcceptRival').change(function () {
                                                if ($(this).val() == 'True') {
                                                    $('#RivalInfo,#joinRival').show();
                                                }
                                                else {
                                                    $('#RivalInfo,#joinRival').hide();
                                                }
                                            });
                                        });
                                    </script>
                                </div>
                            </div>
                            <hr />
                            <div id="RivalInfo" class="row">

                                <div class="span9">
                                    <h4>THÔNG TIN NGƯỜI CÁP KÈO:</h4>
                                </div>
                                <div class="span3">
                                    <label>
                                        Tên đầy đủ
                                    <input name="RivalName" type="text" placeholder="Tên đầy đủ" required="required" value="@Model.UserInfo.FullName">
                                        <div class="alert alert-danger" id="RivalName_Error" style="display: none"></div>
                                    </label>
                                </div>
                                <div class="span3">
                                    <label>
                                        Số điện thoại
                                    <input name="RivalPhone" id="rivalPhone" type="text" placeholder="Điện thoại" required="required" value="@Model.UserInfo.PhoneNumber">
                                        <div class="alert alert-danger" id="RivalPhone_Error" style="display: none"></div>
                                    </label>
                                    <script type="text/javascript">
                                        $('#rivalPhone').keyup(function (event) {
                                            if (isNaN(String.fromCharCode(event.which))) {
                                                var value = $(this).val();
                                                $(this).val(value.substr(0, value.length - 1));
                                            }
                                        });
                                    </script>
                                </div>
                                <div class="span3">
                                    <label>
                                        Email
                                    <input name="RivalEmail" type="text" placeholder="Email" required="required" value="@Model.UserInfo.Email">
                                        <div class="alert alert-danger" id="RivalEmail_Error" style="display: none"></div>
                                    </label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="span9 pull-right">
                                    <p>
                                        <button class="btn btn-primary book-now pull-right groupbtn" type="button" onclick="window.location = '/Stadium/Rivals'">Huỷ bỏ</button>
                                        <button class="btn btn-primary book-now pull-right groupbtn" type="submit" id="joinRival" name="JoinRival">Cáp kèo</button>
                                    </p>
                                </div>
                            </div>
                        }
                        else
                        {
                        <button class="btn btn-primary book-now pull-right groupbtn" id="BackBtn" type="button" onclick="window.location = '/Stadium/Rivals'">Quay lại</button>
                        }
                    </fieldset>
                </form>
            </div>
        </div>
    </div>
</div>
